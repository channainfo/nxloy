# ===========================================
# NxLoy Platform - Environment Variables
# ===========================================
# Copy this file to .env and update with your values
# DO NOT commit .env to version control!

# ===========================================
# DATABASE (Required for Backend)
# ===========================================
DATABASE_URL="postgresql://username:password@localhost:5432/nxloy_dev"

# ===========================================
# BACKEND (apps/backend)
# ===========================================
# Server
PORT=8080
NODE_ENV="development"

# Frontend URL (for OAuth redirects)
# IMPORTANT: Must match Web app port from README.md (8081, not 3001)
FRONTEND_URL="http://localhost:8081"
APP_URL="http://localhost:8080"

# JWT Authentication
JWT_SECRET="your-secret-key-change-in-production-min-32-chars"
JWT_EXPIRES_IN="7d"
JWT_REFRESH_SECRET="your-refresh-secret-key-change-in-production-min-32-chars"
JWT_REFRESH_EXPIRES_IN="30d"

# Session Management
SESSION_SECRET="your-session-secret-key-change-in-production"

# Token Encryption (AES-256-GCM for OAuth tokens)
TOKEN_ENCRYPTION_KEY="your-32-byte-encryption-key-change-in-production-must-be-exactly-32-bytes"

# Email/SMTP Configuration
# ðŸ“– Full SMTP Setup Guide: docs/setup/smtp-setup.md
#
# REQUIRED: All SMTP_* variables are required (no fallback defaults per CLAUDE.md)
# Choose one configuration option below and uncomment it:

# ---- OPTION 1: MailHog (Recommended for Local Development) ----
# Fake SMTP server with web UI at http://localhost:8025
# Install: brew install mailhog
# Start: mailhog
SMTP_HOST="localhost"
SMTP_PORT="1025"
SMTP_SECURE="false"
SMTP_USER=""
SMTP_PASSWORD=""
SMTP_FROM_EMAIL="dev@nxloy.local"
SMTP_FROM_NAME="NxLoy Dev"

# ---- OPTION 2: Gmail (Quick Testing Only) ----
# 1. Enable 2-Step Verification in Google Account
# 2. Generate App Password: https://myaccount.google.com/apppasswords
# WARNING: 500 emails/day limit
# SMTP_HOST="smtp.gmail.com"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="your-email@gmail.com"
# SMTP_PASSWORD="your-16-char-app-password"
# SMTP_FROM_EMAIL="your-email@gmail.com"
# SMTP_FROM_NAME="NxLoy Platform"

# ---- OPTION 3: SendGrid (Recommended for Production) ----
# 1. Sign up at https://sendgrid.com (free tier: 100 emails/day)
# 2. Create API Key: Settings â†’ API Keys
# 3. Verify sender: Settings â†’ Sender Authentication
# SMTP_HOST="smtp.sendgrid.net"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="apikey"
# SMTP_PASSWORD="SG.your-sendgrid-api-key-here"
# SMTP_FROM_EMAIL="verified-sender@yourdomain.com"
# SMTP_FROM_NAME="NxLoy Platform"

# ---- OPTION 4: AWS SES (Best for High Volume) ----
# Setup: https://docs.aws.amazon.com/ses/latest/dg/send-email-smtp.html
# Pricing: $0.10 per 1,000 emails
# SMTP_HOST="email-smtp.us-east-1.amazonaws.com"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="your-ses-smtp-username"
# SMTP_PASSWORD="your-ses-smtp-password"
# SMTP_FROM_EMAIL="verified-sender@yourdomain.com"
# SMTP_FROM_NAME="NxLoy Platform"

# ---- OPTION 5: Mailgun ----
# Free tier: 5,000 emails/month for 3 months
# SMTP_HOST="smtp.mailgun.org"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="postmaster@your-mailgun-domain.com"
# SMTP_PASSWORD="your-mailgun-smtp-password"
# SMTP_FROM_EMAIL="noreply@your-mailgun-domain.com"
# SMTP_FROM_NAME="NxLoy Platform"

# ---- OPTION 6: Postmark (Excellent Deliverability) ----
# Pricing: $15/month for 10,000 emails
# SMTP_HOST="smtp.postmarkapp.com"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="your-postmark-server-token"
# SMTP_PASSWORD="your-postmark-server-token"
# SMTP_FROM_EMAIL="verified-sender@yourdomain.com"
# SMTP_FROM_NAME="NxLoy Platform"

# ---- OPTION 7: Mailtrap (Testing/Staging Only) ----
# No real emails sent, great for staging environments
# Free tier: 500 emails/month
# SMTP_HOST="sandbox.smtp.mailtrap.io"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="your-mailtrap-username"
# SMTP_PASSWORD="your-mailtrap-password"
# SMTP_FROM_EMAIL="noreply@nxloy.local"
# SMTP_FROM_NAME="NxLoy Staging"

# OAuth Providers
# Google OAuth 2.0
GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-google-client-secret"
GOOGLE_CALLBACK_URL="http://localhost:8080/auth/oauth/google/callback"

# Apple Sign In
APPLE_CLIENT_ID="com.nxloy.signin"
APPLE_TEAM_ID="XXXXXXXXXX"  # Apple Developer Team ID
APPLE_KEY_ID="XXXXXXXXXX"   # Key ID from Apple Developer
APPLE_PRIVATE_KEY_PATH="./certs/AuthKey_XXXXXXXXXX.p8"  # Path to .p8 file
APPLE_CALLBACK_URL="http://localhost:8080/auth/oauth/apple/callback"

# Facebook Login
FACEBOOK_APP_ID="your-facebook-app-id"
FACEBOOK_APP_SECRET="your-facebook-app-secret"
FACEBOOK_CALLBACK_URL="http://localhost:8080/auth/oauth/facebook/callback"

# Telegram Login (Bot Token for widget verification)
TELEGRAM_BOT_TOKEN="123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
TELEGRAM_BOT_USERNAME="YourBotUsername"

# PIN Verification
PIN_EXPIRY_EMAIL="15"  # Minutes
PIN_EXPIRY_SMS="10"    # Minutes
PIN_EXPIRY_2FA="5"     # Minutes
PIN_MAX_ATTEMPTS="5"

# Rate Limiting
RATE_LIMIT_TTL="60"          # Time window in seconds
RATE_LIMIT_MAX="100"         # Global max requests per TTL (all endpoints)
RATE_LIMIT_LOGIN="5"         # Max login attempts per TTL
RATE_LIMIT_SIGNUP="3"        # Max signup attempts per TTL
RATE_LIMIT_PASSWORD_RESET="3" # Max password reset per TTL
RATE_LIMIT_PIN_REQUEST="3"   # Max PIN requests per TTL

# Account Lockout
ACCOUNT_LOCKOUT_THRESHOLD="5"  # Failed login attempts before lockout
ACCOUNT_LOCKOUT_DURATION="3600" # Lockout duration in seconds (1 hour)

# ===========================================
# E2E TESTS (apps/backend-e2e)
# ===========================================
# Backend server for E2E tests
HOST="localhost"
# PORT already defined above (8080)

# ===========================================
# WEB (apps/web)
# ===========================================
# Next.js server port
NEXT_PUBLIC_PORT=8081
# Backend API URL for client-side calls
NEXT_PUBLIC_API_URL="http://localhost:8080"

# ===========================================
# MOBILE (apps/mobile)
# ===========================================
# Metro bundler port
EXPO_PUBLIC_PORT=8082
# Backend API URL for mobile app
EXPO_PUBLIC_API_URL="http://localhost:8080"

# ===========================================
# AI-MCP (apps/ai-mcp) - ðŸ“‹ Planned
# ===========================================
# Uncomment when AI-MCP is implemented
# AI_MCP_PORT=8083
# OPENAI_API_KEY="sk-..."
# ANTHROPIC_API_KEY="sk-ant-..."
# MCP_LOG_LEVEL="debug"

# ===========================================
# BLOCKCHAIN (packages/blockchain-contracts) - ðŸ“‹ Planned
# ===========================================
# Uncomment when blockchain is implemented

# EVM Chains (Base, Ethereum)
# ALCHEMY_API_KEY="..."
# DEPLOYER_PRIVATE_KEY="0x..."  # NEVER commit actual private keys!
# BASESCAN_API_KEY="..."
# ETHERSCAN_API_KEY="..."

# RPC Endpoints
# BASE_MAINNET_RPC="https://base-mainnet.g.alchemy.com/v2/YOUR_KEY"
# BASE_SEPOLIA_RPC="https://base-sepolia.g.alchemy.com/v2/YOUR_KEY"
# ETH_MAINNET_RPC="https://eth-mainnet.g.alchemy.com/v2/YOUR_KEY"
# ETH_SEPOLIA_RPC="https://eth-sepolia.g.alchemy.com/v2/YOUR_KEY"

# Solana
# SOLANA_NETWORK="devnet"  # devnet | mainnet-beta
# SOLANA_RPC_URL="https://api.devnet.solana.com"

# Sui
# SUI_NETWORK="testnet"  # testnet | mainnet
# SUI_RPC_URL="https://fullnode.testnet.sui.io"

# IPFS
# PINATA_API_KEY="..."
# PINATA_SECRET_KEY="..."

# ===========================================
# INFRASTRUCTURE - REQUIRED
# ===========================================

# Redis (REQUIRED for QueueModule - email queues, background jobs)
# Note: No fallback defaults allowed per CLAUDE.md - app will fail if not set
REDIS_URL="redis://localhost:6379"
REDIS_HOST="localhost"
REDIS_PORT="6379"
REDIS_PASSWORD=""  # Leave empty for local development
REDIS_TTL="86400"  # Default TTL in seconds (24 hours)

# Cloud Provider (AWS example)
# AWS_REGION="us-east-1"
# AWS_ACCESS_KEY_ID="..."
# AWS_SECRET_ACCESS_KEY="..."

# ===========================================
# MONITORING & OBSERVABILITY - ðŸ“‹ Planned
# ===========================================
# SENTRY_DSN="..."
# DATADOG_API_KEY="..."
# LOG_LEVEL="info"  # debug | info | warn | error
